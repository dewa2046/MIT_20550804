<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <title>ATM DashBoard</title>
        <link rel = "shortcut icon" href = "images/dashboardLogo.ico"/>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <!--refresh every 10min-->
        <meta http-equiv="refresh" content="600">         

        <link href="css/font-awesome.css" rel="stylesheet">
        <link href="css/style.css" rel="stylesheet" type="text/css" />
        <link href="css/bootstrap.css" rel="stylesheet" type="text/css">

        <link href="jQueryAssets/jquery.ui.core.min.css" rel="stylesheet" type="text/css">
        <link href="jQueryAssets/jquery.ui.theme.min.css" rel="stylesheet" type="text/css">
        <link href="jQueryAssets/jquery.ui.slider.min.css" rel="stylesheet" type="text/css">

        <script src="jQueryAssets/jquery-1.11.1.min.js" type="text/javascript"></script>
        <script src="jQueryAssets/jquery.ui-1.10.4.slider.min.js" type="text/javascript"></script>
        <script src="jQueryAssets/jquery.min.js" type="text/javascript"></script>
        <script src="jQueryAssets/modernizr.js" type="text/javascript"></script>
        <script src="jQueryAssets/bootstrap.min.js"></script>
        <script src="jQueryAssets/xlsx.full.min.js"></script>
        <script src="jQueryAssets/jspdf.umd.min.js"></script>


        <script>
            $(window).on('load', function () {
                $(".se-pre-con").fadeOut("slow");
                $('#modelLoad').load("Modal.html");
            });
        </script>
        <script>
            async function onPageLoad() {

                try {
                    var qry = sessionStorage.getItem("ATMFaultEntryReport");
                    var user = sessionStorage.getItem("UName");

                    var arrayrecord_data = [qry];
                    getATMFaultReport(arrayrecord_data);

//                    if (user == null) {
//                        window.location.replace("Login.html");
//                    } else {
//                        $(".se-pre-con").fadeIn("slow");
//                        await sleep(1000);
//                        var arrayrecord_data = [qry];
//                        getATMInfoReport(arrayrecord_data);
//                        $(".se-pre-con").fadeOut("slow");
//                    }

                } catch (e) {
                    alertBox('Error! - ' + e, 'e');
                }
            }
            function loadATMFaultReport(jason_data) {
                try {
                    var unit = jason_data.data;
                    var size = unit.length;
                    clearTable('atmFaultReport');

                    var inputContainer = document.getElementById("atmFaultReportBody");
                    document.getElementById('cnt').innerHTML = size;
                    for (var i = 0; i < size; i++) {
                        
                        var remark = "";
                        if(unit[i]["REMARKS"]){
                            remark = unit[i]["REMARKS"];
                        }

                        var row = document.createElement("tr");
                        addValuetoRows(row, unit[i]["FAULT_ATM"], 'white-space: nowrap;text-align: left;');
                        addValuetoRows(row, unit[i]["FAULT"], 'white-space: nowrap;text-align: left;');
                        addValuetoRows(row, unit[i]["ACTION"], 'white-space: nowrap;text-align: left;');
                        addValuetoRows(row, unit[i]["RESULT"], 'white-space: nowrap;text-align: left;');
                        addValuetoRows(row, remark, 'white-space: nowrap;text-align: left;');                        
                        addValuetoRows(row, unit[i]["USER_NAME"], 'white-space: nowrap;text-align: left;'); 
                        addValuetoRows(row, unit[i]["FAULT_ENTRY_DATE"].slice(0,-2), 'white-space: nowrap;text-align: left;');

                        inputContainer.appendChild(row);
                    }
                } catch (e) {
                    alertBox('Error! - ' + e, 'e');
                }
            }


        </script>
    </head>
    <body onload="onPageLoad()">
        <div class="se-pre-con"></div>

        <!--Load Modal.html-->
        <div id="modelLoad"></div>

        <h1> ATM Fault Entry Report</h1>
        <div class="feedback-w3layouts"> 

            <div class="container">
                <label><i class="fa fa-info-circle" aria-hidden="true"></i> Count :</label>
                <label id="cnt" style="padding-right: 10px;"></label>
                <!--<div class="clear"> </div>-->

                <iframe id="pdfFrame" style="display: none;"></iframe>

                <input type="text" id="myInput" onkeyup="initializeTableFilter('atmFaultReport', 'myInput')" placeholder="Search..." title="Seacrch">
                <button onclick="exportTableToXLSX('atmFaultReport', 'ATM Fault Entry Report')" 
                        id="btndwnloadExcel" style="display: block;float: right;margin: 10px;">
                    <i class="fa fa-file-excel-o" aria-hidden="true"></i>
                    Download (XLSX)
                </button>
                <button onclick="exportTableToPDF('atmFaultReport', 'ATM Fault Entry Report', 'pdfFrame')" 
                        id="btndwnloadPDF" style="display: block;float: right;margin: 10px;">
                    <i class="fa fa-file-pdf-o" aria-hidden="true"></i>             	
                    Download (PDF)
                </button>
                <div class="clear"> </div>
                <table class="fixed_header table-bordered" id="atmFaultReport" style="overflow-x:auto;">

                    <thead>
                        <tr>
                            <th title="Station Name">ATM</th>
                            <th title="Fault">FAULT TYPE</th>
                            <th title="Action">ACTION TYPE</th>
                            <th title="Result">RESULT TYPE</th>
                            <th title="Remark">REMARK</th>
                            <th title="User">CREATED USER</th> 
                            <th title="Created Date">CREATED DATE</th> 

                        </tr>
                    </thead>
                    <tbody id="atmFaultReportBody">

                    </tbody>

                </table>
            </div>

        </div>

        <script src="../ATMDashBoard/js/Common.js"></script>
        <script src="../ATMDashBoard/js/Reports.js"></script>
    </body>
</html>
